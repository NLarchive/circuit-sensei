{
  "$schema": "./level-game.schema.json",
  "id": "level_15_medium",
  "tier": "tier_4",
  "title": "D Flip-Flop with Enable",
  "objective": "Conditional data capture",
  "description": "Build a D-FF that only captures data when Enable=1. When Enable=0, it holds its previous value regardless of clock edges.",
  "introText": "An ENABLED FLIP-FLOP gives fine-grained control over which registers update on each clock cycle. In a CPU register file, only the destination register should change—others must hold their values. The classic solution: use a MUX to select between new Data (when Enable=1) and the current Q output (when Enable=0), feeding the result to a standard D-FF.",
  "physicsVisual": "dff_enable",
  "hint": "Use a MUX: when EN=0, feed Q back to D input. When EN=1, feed Data to D input. The MUX output goes to the D-FF.",
  "availableGates": [
    "transistor",
    "not",
    "and",
    "or",
    "nand",
    "nor",
    "xor",
    "mux2to1",
    "srLatch",
    "dFlipFlop"
  ],
  "inputs": 3,
  "targetSequence": [
    {
      "in": [
        1,
        0,
        0
      ],
      "out": [
        0
      ],
      "desc": "D=1, CLK=0, EN=0: Setup"
    },
    {
      "in": [
        1,
        1,
        0
      ],
      "out": [
        0
      ],
      "desc": "D=1, CLK↑, EN=0: No capture (EN off)"
    },
    {
      "in": [
        1,
        0,
        1
      ],
      "out": [
        0
      ],
      "desc": "D=1, CLK=0, EN=1: Setup with EN"
    },
    {
      "in": [
        1,
        1,
        1
      ],
      "out": [
        1
      ],
      "desc": "D=1, CLK↑, EN=1: Capture D=1"
    },
    {
      "in": [
        0,
        0,
        0
      ],
      "out": [
        1
      ],
      "desc": "D=0, CLK=0, EN=0: Hold Q=1"
    },
    {
      "in": [
        0,
        1,
        0
      ],
      "out": [
        1
      ],
      "desc": "D=0, CLK↑, EN=0: Still hold Q=1"
    }
  ],
  "xpReward": 135,
  "storyText": "CLOCK DISTRIBUTION: A modern CPU clock must reach billions of flip-flops within picoseconds of each other. PLLs (Phase-Locked Loops) are used to multiply low-frequency reference oscillators up to the multi-GHz clock speeds used by modern processors.",
  "physicsDetails": {
    "conceptCards": [
      {
        "term": "D Flip-Flop (Data)",
        "definition": "A memory element that captures its input 'D' only on the active edge of the clock (usually the rising edge). The output 'Q' then holds this value until the next clock edge occurs.",
        "why": "Edge-triggering enables synchronous design—all state changes across a billion-transistor chip happen at the exact same moment, ensuring data is stable before it's used.",
        "analogy": "Like a camera: the input 'D' is the scene, and the clock edge is the shutter click. The resulting photo (Q) captures that one moment regardless of how the scene changes afterward.",
        "latex": "Q(next) = D (at clock edge)",
        "html": "<span class=\"katex\"><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oc</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span></span></span></span>",
        "visuals": [
          {
            "type": "dff_timing",
            "title": "DFF Timing: Sample on Rising Edge"
          }
        ]
      },
      {
        "term": "Edge Triggering",
        "definition": "The flip-flop responds only during the transition of the clock signal (0→1 for positive edge), not while clock is high or low.",
        "why": "Edge triggering prevents multiple captures during a clock period—output changes exactly once per cycle.",
        "analogy": "Like a turnstile: it lets you through only during the moment you push, not while you're holding it.",
        "latex": "Trigger on CLK: 0→1 (rising edge)",
        "html": "<span class=\"katex\"><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">gg</span><span class=\"mord mathnormal\">ero</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span></span></span></span>",
        "visuals": [
          {
            "type": "electric_field",
            "title": "Field Flip on Rising Edge"
          }
        ]
      },
      {
        "term": "Setup Time (t_su)",
        "definition": "The minimum time D must be stable BEFORE the clock edge for reliable capture.",
        "why": "The internal logic needs time to propagate D to the capture point before the clock arrives.",
        "analogy": "Like arriving at the train station before the train departs—too late and you miss it.",
        "visuals": [
          {
            "type": "sr_latch",
            "title": "Internal Capture Timing"
          }
        ],
        "latex": "D stable for t_{su} before clock edge",
        "html": "<span class=\"katex\"><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Ds</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">ab</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">orec</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oc</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span></span></span></span>"
      },
      {
        "term": "Hold Time (t_h)",
        "definition": "The minimum time D must remain stable AFTER the clock edge.",
        "why": "The capture logic needs D to remain stable while it's being latched internally.",
        "analogy": "Like holding still after a camera flash—move too soon and the photo blurs.",
        "latex": "D stable for t_{h} after clock edge",
        "html": "<span class=\"katex\"><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Ds</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">ab</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">erc</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oc</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span></span></span></span>"
      },
      {
        "term": "Metastability",
        "definition": "An unstable state where a flip-flop's output is neither clearly 0 nor 1, oscillating or taking extra time to resolve. Occurs when setup/hold times are violated.",
        "why": "Metastability can cause system failures. Synchronizer chains (2-3 flip-flops) give extra time for resolution.",
        "analogy": "Like a ball balanced on a hill's peak—it will eventually fall to one side, but takes time.",
        "latex": "Resolution time determines reliability",
        "html": "<span class=\"katex\"><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">esolution</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">time</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">determines</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">reliability</span></span></span></span>"
      }
    ],
    "formulaCards": [
      {
        "name": "Maximum Clock Frequency",
        "variables": [
          {
            "symbol": "f_{max}",
            "meaning": "Maximum clock frequency",
            "units": "Hz (GHz for modern CPUs)"
          },
          {
            "symbol": "t_{cq}",
            "meaning": "Clock-to-Q delay (FF output delay)",
            "units": "picoseconds"
          },
          {
            "symbol": "t_{logic}",
            "meaning": "Combinational logic delay between FFs",
            "units": "picoseconds"
          },
          {
            "symbol": "t_{su}",
            "meaning": "Setup time of receiving FF",
            "units": "picoseconds"
          }
        ],
        "meaning": "The clock period must be long enough for data to propagate from one FF through logic to the next FF's input.",
        "derivation": "Data must: (1) exit source FF (t_cq), (2) traverse logic (t_logic), (3) arrive before destination FF setup (t_su).",
        "example": {
          "problem": "Calculate max frequency for: t_cq=50ps, t_logic=150ps, t_su=50ps.",
          "given": [
            "t_cq = 50ps",
            "t_logic = 150ps",
            "t_su = 50ps"
          ],
          "steps": [
            "Period = t_{cq} + t_{logic} + t_{su}",
            "Period = 50 + 150 + 50 = 250ps",
            "f_{max} = \\frac{1}{250ps} = 4GHz"
          ],
          "answer": "f_max = 4GHz"
        },
        "latex": "f_{max} = 1 / (t_{cq} + t_{logic} + t_{su})",
        "html": "<span class=\"katex\"><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ma</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\">1/</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9012em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>"
      },
      {
        "name": "Hold Time Requirement",
        "variables": [
          {
            "symbol": "t_{cq}",
            "meaning": "Source FF clock-to-Q delay",
            "units": "picoseconds"
          },
          {
            "symbol": "t_{logic}",
            "meaning": "Minimum logic delay (could be 0 for direct connection)",
            "units": "picoseconds"
          },
          {
            "symbol": "t_{h}",
            "meaning": "Destination FF hold time",
            "units": "picoseconds"
          }
        ],
        "meaning": "Data must not arrive at the destination FF too quickly—it must hold stable for t_h after the clock edge.",
        "derivation": "If new data arrives before hold time expires, it corrupts the previous capture. Delay must be > t_h.",
        "example": {
          "problem": "Is hold time met if t_cq=30ps, t_logic=0ps (wire), t_h=25ps?",
          "given": [
            "t_cq = 30ps",
            "t_logic = 0ps",
            "t_h = 25ps"
          ],
          "steps": [
            "Data arrival delay = t_{cq} + t_{logic} = 30 + 0 = 30ps",
            "Hold requirement = t_{h} = 25ps",
            "30ps > 25ps? Yes"
          ],
          "answer": "Hold time is met (30ps > 25ps). Safe!"
        },
        "latex": "t_{cq} + t_{logic} > t_{h}",
        "html": "<span class=\"katex\"><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9012em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9012em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>"
      },
      {
        "name": "Metastability MTBF",
        "variables": [
          {
            "symbol": "MTBF",
            "meaning": "Mean Time Between Failures (metastability events)",
            "units": "seconds (years ideally)"
          },
          {
            "symbol": "t_{res}",
            "meaning": "Resolution time (slack for metastability to resolve)",
            "units": "nanoseconds"
          },
          {
            "symbol": "τ (tau)",
            "meaning": "Metastability time constant - how fast the flip-flop resolves unstable states (technology dependent, typically 10-50ps)",
            "units": "picoseconds"
          },
          {
            "symbol": "f_{clk}",
            "meaning": "Clock frequency",
            "units": "Hz"
          },
          {
            "symbol": "f_{data}",
            "meaning": "Data transition rate",
            "units": "Hz"
          },
          {
            "symbol": "T_{window}",
            "meaning": "Timing violation window (setup + hold)",
            "units": "seconds"
          }
        ],
        "meaning": "More resolution time exponentially increases MTBF. This is why we use 2-3 flip-flop synchronizer chains.",
        "derivation": "Each additional FF stage adds resolution time, multiplying MTBF by a huge factor.",
        "example": {
          "problem": "Why do synchronizers use 2+ flip-flops?",
          "given": [
            "Single FF MTBF might be hours",
            "Each FF adds ~30ps resolution time"
          ],
          "steps": [
            "MTBF ∝ exp(t_{res}/τ)",
            "Adding one FF: MTBF \\times 10⁶ (typical)",
            "Two FFs in series: MTBF = years to centuries"
          ],
          "answer": "2 FFs increase MTBF from hours to millions of years—safe for practical systems."
        },
        "latex": "MTBF = exp(t_{res} / τ) / (f_{clk} \\times f_{data} \\times T_{window})",
        "html": null
      }
    ],
    "exercises": [
      {
        "question": "A D flip-flop has D=1 and CLK transitions 0→1. What is Q after the clock edge?",
        "hint": "On rising edge, Q captures D.",
        "answer": "Q = 1 (D is captured at the rising edge)"
      },
      {
        "question": "If t_cq=60ps, t_logic=200ps, t_su=40ps, what is f_max?",
        "hint": "f_max = 1 / T, where T is the total delay through the longest path.",
        "answer": {
          "steps": [
            "1. Calc Total Delay (T): t_cq + t_logic + t_su = 60 + 200 + 40 = 300ps.",
            "2. convert to seconds: 300 × 10⁻¹² s.",
            "3. Calc f_max: 1 / (300 × 10⁻¹²) ≈ 3.33 × 10⁹ Hz.",
            "4. Result: 3.33 GHz."
          ],
          "answer": "3.33 GHz"
        }
      },
      {
        "question": "A design has a timing violation with 10ps negative slack. What are two ways to fix it?",
        "hint": "You need to either slow down or make the path faster.",
        "answer": {
          "steps": [
            "(1) Reduce clock frequency (longer period).",
            "(2) Reduce logic delay (shorter path or faster gates).",
            "(3) Use a faster flip-flop (lower t_cq + t_su)."
          ],
          "answer": ""
        }
      }
    ],
    "realWorld": {
      "context": "D flip-flops are the fundamental building blocks of all synchronous digital systems—from simple counters to billion-transistor CPUs.",
      "example": "A modern CPU has billions of flip-flops. The 4GHz clock must reach them all within ~10ps skew (clock tree design).",
      "numbers": "Apple M1 has ~16 billion transistors. Roughly 10-20% are in flip-flops for registers, pipeline stages, and control logic.",
      "connection": "This level introduces synchronous design—the discipline that makes complex digital systems possible by coordinating all changes to clock edges."
    }
  },
  "maxGates": 2
}